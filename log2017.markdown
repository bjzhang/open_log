
10:13 2017-02-19
----------------
It is hard for to focus on doing something. I could be pushed to work or discuss. But if no one ping me, I just waste my time.
PLAN and DO.
I could think randomly. But I could not focus.
I feel I am dying. I am suicide.

14:39 2017-02-22
----------------
GTD
---
1.  today
    1.  slide for bud17.
        14:46-15:56
        19:18-19:26 晃悠一圈后，还没开始写。
        19:26-  Finish the draft before 19:50.
    2.  supper and rest
        18:00-18:25 supper
        18:25-18:52 rest
    3.  productivity tools. see"19:07 2017-02-22"
        18:52-19:18

19:07 2017-02-22
----------------
productivity, notes
-------------------
1.  similar to slack and trello.
    <https://quip.com/>
    maybe I should try this one? Does quip could sync message from other app like slack? If so, I could use it with my wife.
2.  evernote with markdown
    <http://www.wiz.cn/>
3.  mac/ios only notes and mindmap app:
    <http://www.betternotesapp.com/>
    <https://mindnode.com/>

11:00 2017-02-23
----------------
GTD
---
1.  today
    1.  verify etm range.
        11:01-11:39 It seems that ptm2human could not support the address range.
        TODO: try with trace32.
    2.  DONE: read slide of tee from xiemiao.
        It seems that the core code of CA is located in kernel. We do not need to protect the region in userspace which simiply our design.
    3.  Finish discuss our memory region protection.
        -16:30
    4.  disk partition and sync android code.
        16:31-16:44 Takes more time because I need to umount the partition to speed up the resize.
    5.  clone code.
        16:44-16:55 wait ssh public key valid.
    5.  slide for bud17.

15:01 2017-02-24
---------------
GTD
---
1.  today
    1.  14:10-14:55 CA, TA, Trustzone training.
    2.  tz: read the doc of authentication protocol and think about the flow.
        15:22-15:39 Tired.
    3.  trustzone: read teeos.
        17:07-18:16
        19:11-19:21 tired.
    4.  read arm doc and discussion.
        -18:34
    5.  18:34-19:07 supper.
    6.  19:07-19:11 rest.

10:07 2017-02-25
----------------
GTD
---
1.  today
    1.  try coresight etm range in trace32 simulation mode.
        10:07-10:32  d:\t32\bin\windows64\t32marm.exe -c d:\t32\configsim.t32
                     in simulator, the cpu is arm7TDMI. I could not load binary.
    2. could etm trace software maker？
        走神了。
        15:14-15:37
    3.  16:14-16:35 zone out.
    4.  teeos mm code. memory permission.
        16:38-17:05 工作总是做一些不重要的事情。比如wine安装office，只能安排到5分钟修改时间。
        17:19-17:57 Read the code roughly. Plan to modify it on Monday.

10:51 2017-02-27
----------------
GTD

1.  today
    1.  write coresight environment setup doc(huawei internal).
        10:02-10:40.
    2.  misc, rest
        10:40-10:55
    3.  free talk with my colleague.
        10:55-11:17.
    4.  activity.
        11:18-12:03 I think I should finish it within 20 minutes. The reason is I need to recheck the chat and log. It takes too much time. I should wrote summary everyday.
    5.  help colleague debug coresight:
        14:24-15:02
    6.  align access.
        15:03-15:31 My colleague want to discuss unalignment access of aarch32: vstr. I think it will be an issue when migarte to arm64 kernel no mattter aarch32 or aarch64.
    7.  ILP32: Steve Ellcey send the new version of glibc part.
    8.  read STRIDE doc in huawei.
    9.  check my bill
        15:52-16:00.
    10. I found that if no one ping me. I do not know what I should do. 真不是个自觉的人.
    11. read dmss register. est. 30'
        16:03-16:19
        17:11-18:12 with some discussion with nan wang about etm range filter.
        21:05-21:31
    12. 16:19-17:11 long rest. I am not actually tired. Focus, focus!
    13. performance test of 4k and 64k page. get perf stat.
        19:28-21:02 It takes too long. because I update the code without consistent and I forget this. It is too long to use the script.
                    Also discuss the slide with Mark during try to compile.

10:43 2017-02-28
----------------
GTD
---
1.  today
    1.  每次都是这样，刚刚有一天稍稍认真的工作。马上就要晃悠。感觉自己好没有希望，过了14年，仍然受很差的生活规律困然。
    2.  本周重点工作：
        1.  dmss和海思讨论清楚。
        2.  bud17胶片，手稿。
        3.  出差准备：欧元。
    3.  10:45-11:08 rest.
    4.  read dmss register and set a non-security region.
        11:11-12:30 fail. I suspect dmss could not be read during boot.
        15:41-16:06 fail again.
        16:16-17:11
        17:35-18:19
    5.  12:30-15:00 加上吃饭，睡觉，醒觉一共用了两个半小时。有点长了。我觉得一共一个半小时比较好，也就是半小时吃饭，40分钟睡觉，20分钟醒觉。
    6.  PBC
        15:05-15:41
    7.  bud17 slide.
        18:21-18:25
    8.  下班: 21:55
    6.  read ILP32 patches.
    7.  check perf result.
    8.  comment on bud17 slide: ask tlb hint internally.

2.  TODO
    1.  update STRIDE: 重点是coresight etr寄存器状态审计对于仿冒的防暑。dmss内存权限对于篡改的方式。考虑到打开kvm难度不大，建议审计时加入hyperviosr的HTBR和地址映射的审计(Secure EL3能否访问EL2). exception能不能被过滤?(如果确认了是exeption，可以问问mathieu能不能过滤).

22:05 2017-02-28
----------------
1.  to yury:
    These patches look good to me. Just two comments:
    1.  19/20
        "Adjusted to move the move data page before code pages in sync with"
        should be
        "Adjusted to move the data page before code pages in sync with"?

    2.  I usually use "Bamvor Jian Zhang" instead of "Bamvor Zhang Jian" as my name. It'd better update them in 9/20, 12/20, 14/20, 15/20, 18/20, 19/20 to:
        Signed-off-by: Bamvor Jian Zhang <bamvor.zhangjian@linaro.org>

    And do you plan to test the performance of lmbench and specint? I bisected the performance in lmbench. I think the 1-2 difference is lead by is_comapt_thread and/or exception handler. What do you think about it?

2.  check the status in our 4.1 kernel
    Subject: [PATCH 03/20] asm-generic: Drop getrlimit and setrlimit syscalls from default list

10:14 2017-03-01
----------------
GTD
---
1.  today
    1.  I actually sit down in my desk at 10 o'clock. But I start to work from 10:15. I should save this 15 minutes.
    2.  dmss: add ddr auto gate.
        10:15-10:38
        10:59-11:34
        11:39-12:15
        12:18-12:29 Read dmss register successful.
        17:21-18:19 Read DMSS RTL_INF3 sucessful.
        19:44-  Read current dmss uage.
    3.  lunch
        12:29-13:01
    4.  Fill the leave form.
        13:01-13:19
    5.  coresight cfi design discussion:
        14:30-15:30
    6.  supper and rest.
        18:19-19:24

10:54 2017-03-02
----------------
GTD
---
1.  today
    1.  discuss plan and mis with WANG Nan.
        10:52-11:20
    2.  dmss: set memory attribute.
        11:20-12:11 read asi=6,8 memory attribute.
        12:20-12:44 discuss with colleague.
        14:24-15:03 set dmss cssys attribute.
        15:19-16:14
        16:18-17:19 segfault at first begin. after move to kernel mode. it is ok. But I do not understand why I could read dmss in global task.
        17:55-18:40 update patch.
        1.  set ns cpu could not read.
            00:05-00:51 coding
            00:51-00:53 compile
            00:53-01:31 it not works.
            01:31-01:38 revert TA patch from zhangheng. it could output BAMVOR debug in global_task.c
            02:08-02:38 move coresight_check to trustedcore_src. compile pass.
            02:38-03:26 hang when i read before open_session.
            03:30   debug.
    3.  linaro
        17:35-17:55 1:1 with Mark Brown.
    4.  try CA->TA
        19:48-20:57 fail. 这样我只能在tee global task读etr buffer.
    5.  read and compare etr buffer.
        1.  map etr buffer.
            21:14-21:29 Do not find the memory map info.
            21:29-22:01 find some mapping. To be continued.
        2.  read etr in ta open session of global task.
            22:01-22:07
            22:12-22:38 finsih coding and compile pass.
            22:40-23:20 do not print date.
            23:41 could read etr buffer correctly.
    6.  try dmss permission for coresight.
    7.  23:53-00:04 confirm csdecoder usage.
    7.  rest
        23:47-23:50 收拾桌面.
        23:50-23:53 rest

08:24 2017-03-03
----------------
GTD
---
1.  today
    1.  cfi
        1.  planning.
            8:26-8:28
        1.  decoder.
            1.  try to integrate.
            2.  support exception by Yu Zhong Wen.
        2.  measurement.
            1.  add pmu register.
                8:32-8:35 do not know which one is.
            2.  set in ree. read counter in tee.
        3.  dmss memory protection.
            1.  read register and discuss with Cong Liu.
                8:37-8:51
                9:20-9:57 I set the wrong register: addr_size
                10:00-10:23
                12:01-12:40 do not find a clue.
            2.  debug with blacklog.
                17:20-18:30 Could not upload the log. try next time.
            3.  reorganzie the patch.
        4.  discuss with Shiyuan Hu about obs: ring, subproject and devel package.
            10:30-11:17 TODO write doc.
        5.  11:20-11:49 discuss with zhangheng about ca->ta process.
        6.  cont page hint: 4k THP and 64k comparision.
            12:40-12:47
        7.  plane
            16:17-

13:11 2017-03-04
----------------
GTD
---
1.  today
    1.  write draft for my presantation.
        13:12-???
        14:22-???
    2.  choose the schedule in bud17.
        18:40-19:01
    3.  gpio-mockup: does it support pinctrl? No
        18:34-18:40 19:01-19:04 No. Ask Bartosz if he is interested in it.


18:55 2017-03-04
----------------
plan, linaro connect, bud17
---------------------------
- cont page hint
    - design discussion
- coresight
    - d05 support? four etrs
    - cti use for continuous tracing?
    - perf per-thread buffer connect to etr which could trace multiple thread?
    - make use other resource? sequencer, event(other than viswinst), comparator.
    - make use of data trace, senario?

- trustzone/TEE. development and secure issue, and the following topic:
    - 0308 11:30 am - 11:55 pm BUD17-313 - BoF - Device Tree and Secure Firmware
    - 0309 10:00 am - 10:25 am BUD17-400 - Secure Data Path with OPTEE
    - 0309 12:00 pm - 12:25 pm BUD17-416 - Benchmark and profiling in OP-TEE

- ILP32
    - Upstreaming plan
    - Performance regression analysis.
- OS distribution maintainance
    - How to upgrade to new version: how to build the bootstrap.
    - How to make use of the ring and staging like openSUSE?

10:12 2017-03-05
----------------
1.  today
    1.  I planed to start to work in 10:00. But after I finish shower, I do not start it in time.
        I am hungry. Go to lunch early.
    2.  bud17
        10:20-10:40 try the presentation.
        10:47-11:07 take the notes: bjzhang.github.io/_drafts/2017-03-05-Implement-contiguous-page-hint-for-anonymous-page-in-user-space.md

22:44 2017-03-06
----------------
GTD
---
1.  today
    1.  do the plan
        15:47-15:49
    2.  bud17: finish the draft.
        1.  check the perf_stat and try to explain it.
            15:50-16:18 finish get the data through perf_stat.py
            16:41-16:50 It is hard to think about it.
            17:16-18:09 finish. write a few notes. Need discussw with Arnd later.
        2.  add page table attribute in slide.
        3.  think more about the idea.
        4.  discuss with Arnd(in dinner?) and Agraf(today or tomorror).
    2.  activity

2.  next
    1.  check if we have above page hint patches in our 4.4 kernel?
        if not, we could enable this feature for 4.4 kernel. And we may see good performance improvement with all these improvement(including my cont page hint).

14:36 2017-03-13
----------------
GTD
----
1.  today
    1.  13:30-14:13 Fee.
    2.  rest
        14:13-14:30
    2.  Regular meeting.
        14:30-16:19
        NetApp WAFL(very similar to Btrfs).
        NetApp WAFL: page protect for modifing data.
        1862 what's chip.

14:32 2017-03-14
----------------
GTD
1.  today
    1.  discuss with nan wang about the status of current project.
    2.  Expense Claim. TODO add name of reciever.
    3.  Read doc and discuss about how does should we trust the apps with teeos?
        15:20-

14:14 2017-03-15
----------------
GTD
---
1.  today
    1.  read email.
        14:15-14:23
    2.  STRIBE analysis.
        14:35-15:37
    3.  go back to home. 19:47.
    1.  send two email of people I know in connect.
        Satoru Okamoto <okamoto.satoru@socionext.com>
        Security Working Group:  etienne.carriere@linaro.org
    1.  Read doc and discuss about how does should we trust the apps with teeos?
        delay. Discuss with etienne
    1.  send two email of people I know in connect.

09:35 2017-03-16
----------------
GTD
---
1.  today
    1.  9:31- arrive my table in company.
    2.  read one of TEEOS design doc.
        9:53-9:55
    3.  discuss with Nan Wang and Yuzhong Wen.
        9:55-10:15
    4.  Ask the merge follow of DMSS.
        10:32 Gengyanping is mobile online. wait for a minute.
    5.  discuss with HongJiang Zhao and Nan Wang.
        10:32-11:31
    6.  print the photo in netease yxp.
        13:10-13:40
    7.  DMSS
        14:41-xxx draw mindmap.
    8.  store two name cards in evernote for the people I know last year. Linuxcon or Linaro connect.

22:40 2017-03-16
----------------
reply


On 15 March 2017 at 23:49, Etienne Carriere <etienne.carriere@linaro.org> wrote:
> Hello Bamvor,
>
> Before all, do we agree that the acronym "CA" refers to a "non secure Client
> Application running in the REE" ?
Yes.
>
> I would say it is pretty hard for a TEE to reliably identify a fake CA.
> How can TEE distinguish a rogue CA from a legitimate CA ?
> TEE gets request from non-secure but has no mean to be 100% sure of the CA
> identity.
> The REE could run a legitimate CA and a rogue CA at the same time, and both
> can invoke TEE with the exact same requests parameters (especially if the
> Linux OS was hacked).
Sure. We assume that Linux is already rooted. So, the question is could
we find a trust area even if the kernel is rooted?
>
> If you feel the REE is safe enough to really isolate Client Applications,
> then you application could get a secret (builtin, or provided through a
> secure network connection) and it could invoke the TEE using this secret to
> authentify itself. Of course the TEE shall also get the secret counter part
> from other means (built-in public key, public key received from a secure
> network link, ...).
As you said, the REE could make use of public key. But I am thinking how
to avoid a re-use the same key to do a fake request. At the beginning, I
think I could use random key to avoid it. But if the random key is stored
in memory, then it could be geted through other CPU. So, I suppose the
random key should be only existed in cpu register. But the interrupt
is also need to take into account.

So, go back to my question, is there a best pratice for the transaction
between REE and TEE?
>
> But maybe I don't really understand your need.
> (and remember I am not a security expert, rather a security-aware SW
> developer/integrator)
I think what we discussed is what I care.

Regards

Bamvor
>
> Regards,
> Etienne
>
>
>
>
> On 15 March 2017 at 15:19, Bamvor Zhang Jian <bamvor.zhangjian@linaro.org>
> wrote:
>>
>> Hi, Etienne
>>
>> It is a pity not to discuss with you in Budapest. I read the TEE
>> material recently. The issue is how to identify the fake CA. Could I
>> encrypt the data in an atomic context and use one-time key in REE?
>>
>> Is there a best practice in your hand?
>>
>> Thanks
>>
>> Bamvor
>
>

14:23 2017-03-17
----------------
GTD
---
1.  today
    1.  draw current mindmap for CFC project.
    1.  Summary: coresight and ILP32 of bud17.
        14:28-14:51 cont page hint.
        14:54-15:15 16:37-16:56 coresight.
    1.  read code of dev mem.
        15:15-15:27 dev/kmem for map kernel va. live patching need kernel symbols(not /proc/kallsyms) to do the works.
    1.  add attribute on page table doc.
        15:31-15:40
    1.  chat with Xinwei Hu and Bo LIU(container).
        15:56-16:30 Xinwei is interested in arm server in socionext. He said it is HPC senario.
        16:58-17:31 Send material to xinwei.
    1.  discuss design of CFC.
        --
        19:13-19:58
    1.  reply etienne.

10:52 2017-03-20
----------------
GTD
---
1.  today
    1.  miss the start of morning meeting of CFC.
    2.  discuss with Nan wang about current plan.
        11:16-12:03 update mind map.
    3.  kernel interface changes.
        10:54-11:07 run the script.
        15:06-15:20 15:56-16:04 16:13-16:37 17:30-18:03
    1.  patent: hw page table protection.
        14:18-14:41
    1.  Discuss with Kun LI. page table protection in EL2 with coresight.
        16:33-17:06
    1.  performance regression of ILP32.
        19:21-19:39

10:34 2017-03-21
----------------
GTD
---
1.  today
    1.  the first time I know divide by zero equal to zero.
        20'
    1.  help colleague debug ns bit of page table in secure world.
        11:10-11:30
    1.  move coresight driver to TEE side.
        10:47-11:10 environment setup.
        15:04-15:47 read tmc code. does status in sysfs in enought to config tmc?
        16:01-16:42
        19:27-20:08 20:33-21:04 add some registers in tee.
        call echo.
    1.  fix kselftest.
        14:20-15:00 no big progress.
        16:51-17:00 reply to Michael Ellerman.
    1.  a day of huawei mobile.
        19:05-19:24 document mode.

    1.  read the code of Linux OP-TEE driver and OP-TEE.
    1.  transfer phone number for little dog.
    1.  daily minor task(one day one five minute to clean up):
        1.  store two name cards in evernote for the people I know last year. Linuxcon or Linaro connect.
        2.  after 1 finish: delelet useless 20 auto notes of email in evernote.
    1.  680 coresight etr to ddr requirement.
    1.  linux mindmap? freemap or run simple mind on Linux?

