--- trunk/epan/dissectors/packet-bacapp.c	2012/04/23 07:19:22	42202
+++ trunk/epan/dissectors/packet-bacapp.c	2012/04/23 07:28:53	42203
@@ -4934,20 +4956,30 @@
         } else
             proto_tree_add_uint(subtree, hf_bacapp_tag_lvt,
                 tvb, lvt_offset, lvt_len, *lvt);
+
+        if (*lvt > tvb_length(tvb)) {
+            expert_add_info_format(pinfo, ti, PI_MALFORMED, PI_ERROR,
+                    "LVT length too long: %d > %d", *lvt,
+                    tvb_length(tvb));
+            *lvt = 1;
+        }
     }
+    else if (*lvt > tvb_length(tvb))
+        /* We can't add expert info, but we can still stop infinite loops */
+        *lvt = 1;
 
     return tag_len;
 }
 
 static guint
 fTagHeader (tvbuff_t *tvb, packet_info *pinfo, guint offset, guint8 *tag_no, guint8* tag_info,
     guint32 *lvt)
 {
     return fTagHeaderTree (tvb, pinfo, NULL, offset, tag_no, tag_info, lvt);
 }
 
 static guint
 fNullTag (tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint offset, const gchar *label)
 {
     guint8      tag_no, tag_info;
     guint32     lvt;
