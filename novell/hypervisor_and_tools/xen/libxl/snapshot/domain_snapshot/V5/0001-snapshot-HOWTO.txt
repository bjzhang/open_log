snapshot
--------

Author:
   Bamvor Jian Zhang <bjzhang@suse.com>
   Chunyan Liu <cyliu@suse.com>

Overview:
there are two types of snapshots supported by libxl: disk snapshot and domain
snapshot and four types of operations: create, delete, list and revert.

Disk snapshot will only be crash-consistent if the domain is running. Disk
snapshots can also be internal (qcow2) or external (snapshot in one file, delta
in another).

Domain snapshots include disk snapshots and domain state, allowing to resume
the domain from the same state when the snapshot was created. This type of
snapshot is also referred to as a domain checkpoint or system checkpoint.

Domain snapshot create means save domain state and do disk snapshots.
At the beginning of domain snapshot create, it will check whether it is
snapshotable.

Domain snapshot revert means rollback the current snapshot state.

the domain snapshot information will store in the follow path:
/var/lib/xen/snapshots/<domain_uuid>/snapshotdata-<snapshot_name>.libxl-json
reference patch 0004 for details.

Usage:
reference xl man page and xl.snapshot man page.

Examples:

examples for internal snapshot by options
xl snapshot-create

examples for xl internal snapshot
# cat snapshot_internal
name = "internal_snapshot_after_installation"
description="a snapshot after OS installation. internal snapshot example"
creationtime="1397207580"
save="/var/lib/xen/snapshots/<domain_uuid>/1397207580.save"
# xl snapshot-create snapshot_internal

examples for xl external snapshot
name = "1397207577"
description="a snapshot after OS installation. external snapshot example"
creationtime="1397207577"
save="/var/lib/xen/snapshots/<domain_uuid>/1397207577.save"
disk=[ 'hda=/var/lib/xen/snapshots/<domain_uuid>/disk_hda.qcow2,type=qcow2', 'hdc=/var/lib/xen/snapshots/<domain_uuid>/disk_hdc.qcow2,type=qcow2']

examples for libxl-json

create disk snapshot through libxl_disk_snapshot_create api.
internal snapshot example:
libxl_disk_snapshot snapshot[] =
{
    {
        .device = "hda",
        .name = "your_disk_snapshot_name",
    }
    {
        .device = "hdc",
        .name = "your_disk_snapshot_name",
    }
};
