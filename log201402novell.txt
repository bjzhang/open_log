.LOG
13:27 2014-02-10
GTD
0, 10:00

1, today
1), xl snapshot coding.

09:56 2014-02-11
company, colleague
"Olaf Kirch"_email_"devel] Welcome Roger Zhou"
Dear all,

It is my pleasure to announce that today, Roger (Zhiqiang) Zhou had
his first day at SUSE, as the new manager of the Server Engineering Team
in Beijing. He is coming from WindRiver, where he headed a team of
people in the QA department. For the SLE department, this is a good
start of the Year of the Horse :-)

Please join me in welcoming Roger, and please support him in his new role
as much as you can.

Regards, and a happy new year!
Olaf
--
Wir schwimmen ja ab und zu im Chaosteich...        (N. Pieper)
--------------------------------------------
Olaf Kirch - Director SUSE Linux Enterprise; R&D (okir@suse.com)
SUSE LINUX Products GmbH, Maxfeldstr. 5, 90409 Nürnberg, Germany
GF: Jeff Hawn, Jennifer Guild, Felix Imendörffer, HRB 16746 (AG Nürnberg)

10:02 2014-02-11
virtualization, kvm, package
""Bruce Rogers" <brogers@suse.com>"_email_"[opensuse-virtual] Proposed KVM related packaging changes"_20140211_1747
All,

I proposed making some KVM related packaging changes.

Motivation: Certain aspects of KVM support have changed over
time, and we should adjust to better align to the current state of
affairs. Among these are:
- the KVM modules have been included with the base kernel for
   quite some time
- there is no longer a qemu / qemu-kvm code split upstream
   qemu handles KVM completely 
- on x86, since v3.7 the KVM kernel modules are auto loaded based
   on detection of the required hardware virtualization features 

Our current kvm package originally included the KVM kernel modules,
as well as the QEMU binaries which supported KVM acceleration. As
noted above conditions have changed to where a kvm package has
little of its original purpose. The qemu package now has the basic
support for using KVM, and about the only meaningful use of a kvm
package would be for KVM related configuration or deliverables which
would not be appropriate (for whatever reason) in the qemu package.

The current content of the kvm package in OBS Virtualization includes:
- dependency on qemu package
- a recommends for virt-utils
- the legacy qemu-kvm executable, which is simply a wrapper for the
   QEMU provided executable with the parameter added that enables KVM
   acceleration. I believe this wrapper still provides the useful feature of
   having an executable name, compatible with prior kvm enabled usage.
- man page for qemu-kvm (which maps to qemu)
- a udev rule to change permissions and group ownership of /dev/kvm
   to be compatible with current libvirt usage as well as non-libvirt based
   (ie QEMU command line) kvm group administration.
- a qemu-ifup script which I find useful for testing and creating simple
   usage scenarios
- a kvm_stat tool which allows for monitoring of the lower level KVM
   module activities of the running KVM guests
- in the case of the SLES version of the kvm package, a place for additional
   modprobing, and support documentation, which in effect, rounds out
   the complete base support for KVM.

I propose that we rename (essentially) the kvm package to be qemu-kvm.
This is partly to reduce the number of maintained packages, as I envision
this simply being a subpackage of qemu. This will also make versioning
simpler to maintain. This package will maintain a dependency on qemu.
I propose that the permissions and group ownership udev rule be moved
from qemu-kvm to the base qemu package so that libvirt and etc. can
function without the qemu-kvm package, providing for a slightly smaller
package set and simpler configuration. I propose that the recommends
dependency for virt-utils be removed.

If the additional features and documentation still remaining in qemu-kvm
(the qemu-kvm wrapper and man page, the sample qemu-ifup script, the
kvm_stat debug utility, possible scripts for modprobing of additional kernel
modules which enhance qemu-kvm usage (eg vhost-net), and the support
documentation) are desired, then that package may be installed, but it is not
considered essential for basic KVM support.

The virt-utils package currently provides little value. It was envisioned as a
place to collect generic utilities useful for either KVM or Xen virtualization,
but to date very little has been done there. QEMU based utilities are now in
qemu-tools, and the only utility in virt-utils is the unmaintained
vm-snapshot-disk. I propose that we eliminate this package, but if there is
objection, and someone relies on the vm-snapshot-disk feature, we can keep
it, but not have it be part of the default set of rpms installed by KVM Host
Server pattern.

If there are dependencies on the kvm package name which will take time to
remove, we could have that stripped down package simply require qemu-kvm
in the interim.

Comments on these proposed changes are of course welcome.

Thanks,

Bruce Rogers

10:19 2014-02-11
GTD
0, 9:40

1, today
1), 10:20-12:11 16:11-16:40 xl snapshot coding. see"10:20 2014-02-11"
2), 1h suse EVP. see"12:31 2014-2-11"
3), 1.5h suse all hands. see"14:07 2014-02-11"

10:20 2014-02-11
xl snapshot coding
1, TODO
vm-snapshot-disk? for what?
bamvor@laptop-work:log> rpm -ql virt-utils
/usr/bin/vm-snapshot-disk

i know this from Bruce email.

2, finish disk snapshot code: could snapshot all the disk for the specific domain.
not test yet.

3, flow about save and snapshot:
1), mine
stop
snapshot
save memory
2), read the qemu and xm code.

4, qemu flow
QEMUSnapshotInfo

12:31 2014-2-11
suse employee value proposition
David

13:12 2014-2-11
In order for JACK to work, your user needs to be added to the audio group for direct access to hardware.

usermod -a -G audio bamvor
laptop-work:/home/bamvor/log # cat /etc/group |grep audio
audio:x:17:pulse,bamvor

it is ok after this.

14:07 2014-02-11
suse, all hands
1,
suse 86% of plan.
total 93% of plan.

geo:
only EMEA 103% of plan. is over 100% of plan.

ref: "12:37 2013-10-29"3 for license, maintenance, service.

2, suse:
1), Q3
North American -22% of prior in Q3FY14.
Huawei is the top of transactions in APAC in Q3FY14.
2), Q4 forecast
oppotunity:
Deutsche Back $5.7M, UK.

3, Suse success Q3 AP: China UnionPay.
1),
up to 4000 servers.
2), response:
Strong alliance with hardware provider Sugon(曙光).
3), result:
SLES+xen.
over 600 SLES systems deployed.
addition 2000 systems expected over next two years.

4, 25years.
bruce and charles.

5, steady social media channel growth.
1), song
2), blog: kGraft: live kernel patching.

6, Strategy and Execution.

7, SUSE Cloud 3
HA: ETA: March 2014.
suse customer center.
ceph.

15:16 2014-02-11
software skill, mail, groupwise
1, referece Tim's blog:
http://ourobengr.com/2013/03/opensuse-12-3-lenovo-t430/
1), there is no need to install libXm.so.3 so as to libXm.so.4. according to Tim's blog. i installed the openmotif-libs(64bits), so i could prove that libXm.so.3 32bits is useless for me(i could start groupwise, open and send mail).
2), need install libpangox-1_0-0-32bit to avoid libwebrenderer crash.
JRE log(hs_err_pid5433.log):
# Problematic frame:
# C  [libwebrenderer.so+0xde3ff]  _ZN14WRSwingBrowser6WRInitEv+0x13f
#

2, about libpangox
Pango is a library for layout and rendering of text, with an emphasis
on internationalization. It can be used anywhere that text layout
is needed.
Pango forms the core of text and font handling for GTK+.
This is a compatibility library providing the obsolete pangox library
that is not shipped by Pango itself anymore.

09:05 2014-02-12
sync meeting
1, about virtualization team
16 engineer on virtualization.
Jason: virtualization manager from 2009.

2, Chunyan
1), talk about volume create.  qemu-img, qcow-create.
2), direct kernel boot.
upstream qemu is not good for this feature. need work.

3, xm snapshot fate
1), xen
(1), disk snapshot
(2), vm snapshot.

12:43 2014-02-12
GTD
0, 11:08

1, today
1), 12:43- 20:23 xl snapshot coding. see"12:43 2014-02-12".

12:43 2014-02-12
xl snapshot coding
1, continue reading the qemu and xm code.
1), how to manage the snapshot list?
2), do i need to write all the snapshot image to one file?
3), it seems that libxl will stop the domain during libxl_domain_suspend. which means i need to avoid to stop the domain during snapshot.
4), in xen hvm save, how to deal with qemu process? from the function name, libxl__domain_save_device_model should handle this. but i do not know how it works.
and in xen pv save, do i need to care about qemu?
5), discuss with Chunyan. Chunyan suggest me make the disk snapshot work at first.
Chunyan said that in the xen old snapshot. xen will check the qcow2 snapshot in qcow2 file.

2, reference the follow patch for how to add the qmp command
From bbe860104f0544d7863296606e042cc62bf7ab4b Mon Sep 17 00:00:00 2001
From: Wenchao Xia <xiawenc@linux.vnet.ibm.com>
Date: Wed, 11 Sep 2013 14:04:34 +0800
Subject: [PATCH] qmp: add internal snapshot support in qmp_transaction

From f323bc9e8b3b46ad28402995a9dcaaeff3eb5e03 Mon Sep 17 00:00:00 2001
From: Wenchao Xia <xiawenc@linux.vnet.ibm.com>
Date: Wed, 11 Sep 2013 14:04:35 +0800
Subject: [PATCH] qmp: add interface blockdev-snapshot-internal-sync

3, add blockdev-snapshot and blockdev-internal-snapshot. this should be easier than transaction.

15:59 2014-02-12
virtualization, doc, some info about qemu with xen
http://wiki.xen.org/wiki/QEMU_Upstream

Xen Qemu Trees
These can be found on xenbits in 'qemu-upstream-VERSION.git' e.g. qemu-upstream-unstable.git, qemu-upstream-4.3-testing.git.
By default the Xen build system will clone and build both versions of Qemu from the branches on xenbits.

Using a distribution supplied version of Qemu
    ./configure --with-system-qemu=/path/some/qemu-bin/

override the binary to be used via device_model_override field in your xl vm configuration (other toolstacks may or may not expose this option). For example:
    device_model_override = "/usr/bin/qemu-system-x86_64"
Note that it is you responsibility to ensure that 'device_model_version' is set to either 'qemu-xen-traditional' or 'qemu-xen' as appropriate when overriding the binary to use.

13:35 2014-02-13
virtualization, libvirt, libxl
http://jfehlig.wordpress.com/2014/01/05/libvirt-support-for-xens-new-libxenlight-toolstack/
two contribution are welcome according to Jim's blog
1, attach xl domain to libvirt.
2, support domain 0 in libvirt.

13:37 2014-02-13
GTD
1, today
1), 13:37-17:39 xl snapshot coding. see"13:38 2014-02-13"
2), Summary: 怎么也睡不够, 昨天至少11点就睡, 到下午两点咋就又困了!

13:38 2014-02-13
xl snapshot coding
1, compile the code and test the block device snapshot internal.
2, test disk internal snapshot ok.
# xl disk_snapshot_internal bjz_04_sles11_sp2 ide-hd2 snapshot_02131643
libxl: error: libxl_qmp.c:315:qmp_handle_error_response: received an error message from QMP server: Device 'ide-hd2' not found
# xl disk_snapshot_internal bjz_04_sles11_sp2 hdc snapshot_02131643
# xl disk_snapshot_internal bjz_04_sles11_sp2 hdc snapshot_02131643
libxl: error: libxl_qmp.c:315:qmp_handle_error_response: received an error message from QMP server: Snapshot with name 'snapshot_02131643' already exists on device 'hdc'

3, TODO
1), add query-block, delete disk internal snapshot.
2), try transaction.
3), save memory and snapshot.
4), think about revert snapshot.

11:17 2014-02-14
software skills, network, enable /etc/hosts
1, # /etc/init.d/network restart
redirecting to "systemctl  restart network.service"
2, flush iptables?

11:25 2014-02-14
GTD
1, today
1), 11:26-11:36 xl snapshot coding. see"11:27 2014-02-14"

11:27 2014-02-14
xl snapshot coding
1), add query-block, delete disk internal snapshot.

11:34 2014-02-14
software skills, editor, vim, disable auto indent when paste
1, http://stackoverflow.com/questions/2514445/turning-off-auto-indent-when-pasting-text-into-vim

Pavel Shved:
To turn off autoindent when you paste code, there's a special "paste" mode.

Type

:set paste
Then paste your code. Note that the text in the tooltip now says -- INSERT (paste) --.

After you pasted your code, turn off the paste-mode, so that auto-indenting when you type works correctly again.

:set nopaste

2, vim help
http://vim.wikia.com/wiki/Toggle_auto-indenting_for_code_paste

15:19 2014-02-14
Xia Li
1, system crash
1), libvirtd
38 14:48:48.981: 2866: warning : qemuDomainObjTaint:1110 : Domain id=23 name='opensuse131rc-1' uuid=e18155a8-44a1-b5a3-bada-0a48324bd70b is taint    ed: high-privileges
39 14:49:13.455: 2863: error : daemonStreamHandleAbort:590 : stream aborted at client request
40 14:49:17.439: 2863: error : daemonStreamHandleAbort:590 : stream aborted at client request
41 14:49:23.767: 2863: error : virNetSocketReadWire:904 : Cannot recv data: Connection reset by peer
42 14:49:49.351: 2867: error : remoteDispatchSupportsFeature:11603 : internal error connection not open
43 14:58:34.241: 2865: warning : qemuDomainObjTaint:1110 : Domain id=24 name='opensuse131rc-1' uuid=e18155a8-44a1-b5a3-bada-0a48324bd70b is taint    ed: high-privileges
44 14:59:25.875: 2863: error : virNetSocketReadWire:904 : Cannot recv data: Connection reset by peer
45 14:59:31.137: 2867: error : remoteDispatchSupportsFeature:11603 : internal error connection not open
46 15:00:55.102: 2867: warning : qemuDomainObjTaint:1110 : Domain id=25 name='opensuse131rc-1' uuid=e18155a8-44a1-b5a3-bada-0a48324bd70b is taint    ed: high-privileges
47 15:01:55.540: 2863: error : virNetSocketReadWire:904 : Cannot recv data: Connection reset by peer
48 15:02:31.044: 2868: error : remoteDispatchSupportsFeature:11603 : internal error connection not open
49 15:02:32.052: 2863: error : virNetSocketReadWire:912 : End of file while reading data: Input/output error
2), qemu, opensuse131rc-1
204 2014-02-14 15:00:55.102: starting up
205 LC_ALL=C PATH=/sbin:/usr/sbin:/usr/local/sbin:/root/bin:/usr/local/bin:/usr/bin:/bin:/usr/bin/X11:/usr/X11R6/bin:/usr/games:/opt/kde3/bin:/usr    /lib64/jvm/jre/bin:/usr/lib/mit/bin:/usr/lib/mit/sbin:/opt/novell/iprint/bin HOME=/root USER=root LOGNAME=root TMPDIR=/tmp QEMU_AUDIO_DRV=none     /usr/bin/qemu-kvm -S -M pc-0.15 -enable-kvm -m 1024 -smp 2,sockets=2,cores=1,threads=1 -name opensuse131rc-1 -uuid e18155a8-44a1-b5a3-bada-0a    48324bd70b -nodefconfig -nodefaults -chardev socket,id=charmonitor,path=/var/lib/libvirt/qemu/opensuse131rc-1.monitor,server,nowait -mon chard    ev=charmonitor,id=monitor,mode=control -rtc base=utc -no-shutdown -drive file=/mnt/vmdisk/images/opensuse131rc-1/disk0.raw,if=none,id=drive-id    e0-0-0,format=raw -device ide-drive,bus=ide.0,unit=0,drive=drive-ide0-0-0,id=ide0-0-0,bootindex=1 -netdev tap,fd=25,id=hostnet0 -device rtl813    9,netdev=hostnet0,id=net0,mac=52:54:00:3e:9b:8d,bus=pci.0,multifunction=on,addr=0x3.0x0 -chardev pty,id=charserial0 -device isa-serial,chardev    =charserial0,id=serial0 -usb -vnc 127.0.0.1:5 -vga cirrus -device AC97,id=sound0,bus=pci.0,multifunction=on,addr=0x4.0x0 -device virtio-balloo    n-pci,id=balloon0,bus=pci.0,multifunction=on,addr=0x5.0x0
206 Domain id=25 is tainted: high-privileges
207 char device redirected to /dev/pts/10
208 qemu: terminating on signal 15 from pid 2863
209 2014-02-14 15:02:31.648: shutting down

2,
1), it seems that the disk is crash. we could not mount the disk image from host.
2), TODO: check about taint.
Chunyan: vm taint should be 0 in ProcessStop.

09:46 2014-02-17
company, IT
1, novell
ServiceDesk ServiceDesk@novell.com
2, suse
From: "Lars Vogdt <lrupp@suse.de>"_"[devel] Migration of imap.suse.de on Thursday, 2014-02-20, 08:00 - 10:00 CET"_20140217
Please open a ticket via
   https://infra.nue.suse.com/
or by sending an Email to
  infra@suse.de
if you encounter any troubles after the migration.

10:14 2014-02-17
kernel training, basic knowledge
1, Sleep locks
Shows up as "D" state in ps output. (others could output D state as well, TODO search it).
2, process
can and can't. something is implemented by issue system calls.
3, Scheduler
1), test: if you want to test scheduler, need many threads to run.
2), process affinity
http://en.wikipedia.org/wiki/Processor_affinity
cpu shielding.
http://en.wikipedia.org/wiki/CPU_shielding
4, memory
1), what does "sparse mapping" mean?
2), free the clean pages when needed. e.g. free the inode cache.
5, nmap
1), different types.
(1), no backing file, can only be freed and swapped.
(2), nmap with backing file.
(3), nmap with backing file. private mapping: could only read from fs. could write to swap.
6, shared libraries
1), waste less disk space.
7, NUMA
1), memory-interleaving?

14:04 2014-02-17
kernel training, network
1, layer:
application
transport(L4)
internet(L3)
link(L2)
physical
2, bridge frame filtering.
ebtables.
bridge happens at link layer.
3,routing: happens at internetwork layer.
173.194.64.0/18
18: means 8 + 8 + 2 mask. 18bits are network poart. lower 14bits are host part.
1), routing tables
ip route show
> ip route show
default via 147.2.215.254 dev wlan0  proto static
147.2.215.0/24 dev wlan0  proto kernel  scope link  src 147.2.215.149

classless inter-domain routing(CIDR) natation.

(2), ip route get 151.155.216.12
151.155.216.12 via 10.100.200.1 dev tun0 src 10.100.200.60
(3), 0-255 routing tables
254 -- default routing table
255 -- connected networks
2), ip rules
4, packet filtering
5, rp filter
http://tldp.org/HOWTO/Adv-Routing-HOWTO/lartc.kernel.rpf.html
Reverse Path Filtering
6, no communication over netowrk?
1), ip neihgbor show
2), ping and arping
ping uses ICMP protocol, which can be filtered. IP level.
arping works with ARP protocol, usually not filtered but the tool needs superuser privileges.
BTW: traceroute could also diagnose the problem between networks.
3), tcpdump.
man 7 pcap-filter (package libpcap1)
wireshark
4),
Packet flow in Netfilter and General Networking
http://inai.de/images/nf-packet-flow.svg
5), ethtool
6), others:
(1), iptraf: ip trafic tools.
e.g. statics for specific interface. ip packet.
(2), netstat.
(3), ip -s link show

17:00 2014-02-17
GTD
1, today
1), 10:00-11:40 kernel training: basic knowledge.
2), 14:00-16:40 kernel training: network

10:01 2014-02-18
kernel training, devices and drivers; summary, doc, useful file and commands
0, Summary
1), tools: "lspci -s xx:xx.x -v", modinfo
2), files: "/proc/interrupts"
1, driver: translate one layer to another layer.
e.g. emu 10k1(drivers/input/gameport/emu10k1-gp.c): translate from pci layer to gameport layer.
2, lspci:
laptop-work:/home/bamvor # lspci -s 09:00.0 -v
09:00.0 Ethernet controller: Broadcom Corporation NetXtreme BCM5761e Gigabit Ethernet PCIe (rev 10)
        Subsystem: Dell Device 0432
        Flags: bus master, fast devsel, latency 0, IRQ 53
        Memory at f65e0000 (64-bit, non-prefetchable) [size=64K]
        Memory at f65f0000 (64-bit, non-prefetchable) [size=64K]
        Capabilities: [48] Power Management version 3
        Capabilities: [40] Vital Product Data
        Capabilities: [60] Vendor Specific Information: Len=6c <?>
        Capabilities: [50] MSI: Enable+ Count=1/1 Maskable- 64bit+
        Capabilities: [cc] Express Endpoint, MSI 00
        Capabilities: [100] Advanced Error Reporting
        Capabilities: [13c] Virtual Channel
        Capabilities: [160] Device Serial Number 00-26-b9-ff-fe-69-16-37
        Capabilities: [16c] Power Budgeting <?>
        Kernel driver in use: tg3
3, DMA
DMA, BM; Scatter-Gather(SG, SGIO).
4, interrupt
1), history
(1), 8259 PIC
edge triggered.
(2), APIC
edge triggered, level triggered, fasteoi.
(3), MSI, MSI-X.
delivered as messages over PCI or PCIe bus.

2), list interrupt in my desktop.
# cat /proc/interrupts
           CPU0       CPU1       CPU2       CPU3       CPU4       CPU5       CPU6       CPU7
  0:        122          0          0          0          0          0          0          0  IR-IO-APIC-edge      timer
  1:          3          0          0          0          0          0          0          0  IR-IO-APIC-edge      i8042
  8:          1          0          0          0          0          0          0          0  IR-IO-APIC-edge      rtc0
  9:          0          0          0          0          0          0          0          0  IR-IO-APIC-fasteoi   acpi
 12:          4          0          0          0          0          0          0          0  IR-IO-APIC-edge      i8042
 16:         28          0          0          0          0          0          0          0  IR-IO-APIC-fasteoi   ehci_hcd:usb1
 17:     358734          0          0          0          0          0          0          0  IR-IO-APIC-fasteoi   ehci_hcd:usb2
 40:          0          0          0          0          0          0          0          0  DMAR_MSI-edge      dmar0
 42:     942635          0          0          0          0          0          0          0  IR-PCI-MSI-edge      ahci
 43:    2107729          0          0          0          0          0          0          0  IR-PCI-MSI-edge      radeon
 44:         25          0          0          0          0          0          0          0  IR-PCI-MSI-edge      mei
 45:    6025751          0          0          0          0          0          0          0  IR-PCI-MSI-edge      em1
 46:        733          0          0          0          0          0          0          0  IR-PCI-MSI-edge      snd_hda_intel
NMI:       1863       1392       1162       1257        373        346        354        454   Non-maskable interrupts
LOC:    5754690    4714652    4318947    4500641    1405557    1069221    1157511    1121507   Local timer interrupts
SPU:          0          0          0          0          0          0          0          0   Spurious interrupts
PMI:       1863       1392       1162       1257        373        346        354        454   Performance monitoring interrupts
IWI:          0          0          0          0          0          0          0          0   IRQ work interrupts
RTR:          0          0          0          0          0          0          0          0   APIC ICR read retries
RES:    2332990     889409      46541      16955      10556       8518       7900       7987   Rescheduling interrupts
CAL:       2278       7837       8103       7254       7344       8285       8297       8396   Function call interrupts
TLB:     119932     120889     114599     101929      54884      53147      51631      56574   TLB shootdowns
TRM:          0          0          0          0          0          0          0          0   Thermal event interrupts
THR:          0          0          0          0          0          0          0          0   Threshold APIC interrupts
MCE:          0          0          0          0          0          0          0          0   Machine check exceptions
MCP:       1149       1149       1149       1149       1149       1149       1149       1149   Machine check polls
ERR:          0
MIS:          0
3), it could be for diagnose. if a hardware works wrong, the interrupt counter will not increase.

5, the difference between PCI and PCIe
1), PCI is parallel, PCIe is serial.
2), the lane is given to the specific pcie devices. compare with PCI, the bandwidth is shared.

6, examples: emu 10k1(drivers/input/gameport/emu10k1-gp.c): translate from pci layer to gameport layer.

7, examples: /dev/null(drivers/char/mem.c)
1), the major number of mem device is 1.
# cat /proc/devices | head
Character devices:
  1 mem
  4 /dev/vc/0
  4 tty
  5 /dev/tty
  5 /dev/console
  5 /dev/ptmx
  7 vcs
 10 misc
 13 input

8, examples: usb printer
drivers/usb/class/usblp.c
1), modinfo usblp
# modinfo usblp
filename:       /lib/modules/3.7.10-1.16-xen/kernel/drivers/usb/class/usblp.ko
license:        GPL
description:    USB Printer Device Class driver
author:         Michael Gee, Pavel Machek, Vojtech Pavlik, Randy Dunlap, Pete Zaitcev, David Paschal
srcversion:     BD8A318D5C286F1E78768B9
alias:          usb:v04B8p0202d*dc*dsc*dp*ic*isc*ip*in*
alias:          usb:v*p*d*dc*dsc*dp*ic07isc01ip03in*
alias:          usb:v*p*d*dc*dsc*dp*ic07isc01ip02in*
alias:          usb:v*p*d*dc*dsc*dp*ic07isc01ip01in*
alias:          usb:v*p*d*dc07dsc01dp03ic*isc*ip*in*
alias:          usb:v*p*d*dc07dsc01dp02ic*isc*ip*in*
alias:          usb:v*p*d*dc07dsc01dp01ic*isc*ip*in*
depends:        usbcore
intree:         Y
vermagic:       3.7.10-1.16-xen SMP mod_unload modversions Xen
parm:           proto_bias:Favourite protocol number (int)

2), urb: usb request block.

9, examples: network
drivers/net/ethernet/dec/tulip/dmfe.c
DMA_BIT_MASK(32): if the system do not support iommu or software mmu, it will fail.

10, QA
1), spin_lock_irqsave/spin_lock_irqrestore: save the irq status before the spin_lock_irqsave and restore it after irqrestore.

11:46 2014-02-18
linux, kernel, how the avoid the useless mismatch check
/*
 * modpost check for section mismatches during the kernel build.
 * A section mismatch happens when there are references from a
 * code or data section to an init section (both code or data).
 * The init sections are (for most archs) discarded by the kernel
 * when early init has completed so all such references are potential bugs.
 * For exit sections the same issue exists.
 *
 * The following markers are used for the cases where the reference to
 * the *init / *exit section (code or data) is valid and will teach
 * modpost not to issue a warning.  Intended semantics is that a code or
 * data tagged __ref* can reference code or data from init section without
 * producing a warning (of course, no warning does not mean code is
 * correct, so optimally document why the __ref is needed and why it's OK).
 *
 * The markers follow same syntax rules as __init / __initdata.
 */
#define __ref            __section(.ref.text) noinline
#define __refdata        __section(.ref.data)
#define __refconst       __constsection(.ref.rodata)

13:56 2014-02-18
ref: https://www.soljerome.com/blog/2011/05/07/using-kpartx-to-read-lvm-volumes/
https://www.centos.org/docs/5/html/Virtualization-en-US/ch-virt-accessing-data.html
kpartx
SLES11Host:~ # vgdisplay
  Couldn't find device with uuid TYfh5v-TB0B-T3O2-izta-KUfO-n8I7-KPDH3d.
  Skipping clustered volume group cluster-vg
  --- Volume group ---
  VG Name               vg_sdb
  System ID
  Format                lvm2
  Metadata Areas        3
  Metadata Sequence No  4
  VG Access             read/write
  VG Status             resizable
  MAX LV                0
  Cur LV                3
  Open LV               3
  Max PV                0
  Cur PV                3
  Act PV                3
  VG Size               299.99 GiB
  PE Size               4.00 MiB
  Total PE              76797
  Alloc PE / Size       7680 / 30.00 GiB
  Free  PE / Size       69117 / 269.99 GiB
  VG UUID               2JIYA5-25ne-TX0I-Yjpa-OKsH-3W0K-mLqZcL

  --- Volume group ---
  VG Name               vg_vm
  System ID
  Format                lvm2
  Metadata Areas        2
  Metadata Sequence No  24
  VG Access             read/write
  VG Status             resizable
  MAX LV                0
  Cur LV                14
  Open LV               3
  Max PV                0
  Cur PV                2
  Act PV                2
  VG Size               199.99 GiB
  PE Size               4.00 MiB
  Total PE              51198
  Alloc PE / Size       35840 / 140.00 GiB
  Free  PE / Size       15358 / 59.99 GiB
  VG UUID               1NynGW-NPcm-io8F-kFnq-Ru9U-6W2b-N34IQ3

# kpartx --help
kpartx: invalid option -- '-'
usage : kpartx [-a|-d|-l] [-f] [-v] wholedisk
        -a add partition devmappings
        -r devmappings will be readonly
        -d del partition devmappings
        -u update partition devmappings
        -l list partitions devmappings that would be added by -a
        -p set device name-partition number delimiter
        -g force GUID partition table (GPT)
        -f force devmap create
        -v verbose
        -s sync mode. Don't return until the partitions are created

# fdisk -l /dev/vg_vm/lv_vm4

Disk /dev/vg_vm/lv_vm4: 10.7 GB, 10737418240 bytes
255 heads, 63 sectors/track, 1305 cylinders, total 20971520 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk identifier: 0x00004fe2

             Device Boot      Start         End      Blocks   Id  System
/dev/vg_vm/lv_vm4p1            2048     2297855     1147904   82  Linux swap / Solaris
/dev/vg_vm/lv_vm4p2   *     2297856    18745343     8223744   83  Linux
/dev/vg_vm/lv_vm4p3        18745344    20971519     1113088   83  Linux

# kpartx -a
# ls /dev/mapper/
control         vg_sdb-lv_sd3   vg_vm-lv_vm11   vg_vm-lv_vm14   vg_vm-lv_vm4    vg_vm-lv_vm4p3  vg_vm-lv_vm7
vg_sdb-lv_sd1   vg_vm-lv_vm1    vg_vm-lv_vm12   vg_vm-lv_vm2    vg_vm-lv_vm4p1  vg_vm-lv_vm5    vg_vm-lv_vm8
vg_sdb-lv_sd2   vg_vm-lv_vm10   vg_vm-lv_vm13   vg_vm-lv_vm3    vg_vm-lv_vm4p2  vg_vm-lv_vm6    vg_vm-lv_vm9
SLES11Host:~ # mount  /dev/mapper/vg_vm-lv_vm4p1 /mnt/
/dev/mapper/vg_vm-lv_vm4p1 looks like swapspace - not mounted
mount: you must specify the filesystem type
SLES11Host:~ # mount  /dev/mapper/vg_vm-lv_vm4p2 /mnt
mount: warning: /mnt seems to be mounted read-only.
SLES11Host:~ # df -h
Filesystem                  Size  Used Avail Use% Mounted on
/dev/sda1                    99G   27G   67G  29% /
devtmpfs                    3.9G  328K  3.9G   1% /dev
tmpfs                       3.9G  124K  3.9G   1% /dev/shm
/dev/mapper/vg_vm-lv_vm4p2  7.8G  4.9G  2.5G  67% /mnt
SLES11Host:~ # mount
/dev/sda1 on / type ext3 (rw,acl,user_xattr)
proc on /proc type proc (rw)
sysfs on /sys type sysfs (rw)
devtmpfs on /dev type devtmpfs (rw,mode=0755)
tmpfs on /dev/shm type tmpfs (rw,mode=1777)
devpts on /dev/pts type devpts (rw,mode=0620,gid=5)
fusectl on /sys/fs/fuse/connections type fusectl (rw)
securityfs on /sys/kernel/security type securityfs (rw)
none on /proc/sys/fs/binfmt_misc type binfmt_misc (rw)
gvfs-fuse-daemon on /root/.gvfs type fuse.gvfs-fuse-daemon (rw,nosuid,nodev)
/dev/mapper/vg_vm-lv_vm4p2 on /mnt type ext4 (ro)

14:11 2014-02-18
kernel training, filesystem
1, local, network(nfs), cluster, distributed: CEPH, vitual: FUSE.
ntfs in usespace.
2, ways to initiate file system I/O
1), Buffered I/O
2), Asynchronous I/O
3), Direct I/O: bypass the cache.
3, struct super_block: only one in one filesystem.
inodes: alloc, free, dirty, write, evict
stafs
quotas
cleanup
4, struct inode.
5, struct dentry: one per filename on filesystem.
6, namespace vs file system.
7, struct mount: one per mount point.
8, reiserfs
9, OCFS2.
10, btrfs.
11, linux block I/O.
12, device mapper
a generic mechanism for mapping a bio to another bio.

16:25 2014-02-18
GTD
1, today
1), kernel training, devices and drivers.
2), kernel training, filesystem.
3), work report(no send).

16:51 2014-02-18
work report
1, fate#316276: XEN: Bring back the Xen snapshot functionality
write code and test "create the internel snapshot". it is ok.

16:54 2014-02-18
snapshot
1, delete snapshot
coding finish. test tomorrow.

10:21 2014-02-19
1,
1), introduce types for virtualization: xen, kvm and LXC.
2), introduce xen and kvm and comparing with Vmware/Hyper-V.
3), virtualization tools: virt-manager.
4), advanced features
(1), paravirt
(2), live migration.
(3), hardware passthrough
2, xen, kvm
1), Vmware/hyper-V: virtualize all the things. including drivers.
2), xen: virtualize cpu, memory, and something else. Vmware ESX uses Linux for management.
3), kvm: only virtualize cpu and memory.
3, qemu
1), using system-mode for SUSE arm64.
3times faster than arm simulator provided by arm.
4, paravirtualization make the live migration eariler.
5, hardware passthrough
1), easy on USB
USB is an abstracted protocol. endpoint and pipe.
2), much tougher on PCI and PCIe.
(1), PCI does DMA.
(2), IOMMU is required.(AMD Vi or Intel VT-D).
(3), graphics cards ofter use legacy capabilities, that can't be passed.
e.g. graphics use ioport.
some video card. some don't.
6, memory deduplication
1), CONFIG_KSM: kernel samepage merging.
madvise(addr, length, MADV_MERGEABLE)
similar to COW(Copy On Write).
7, vhost-net
achieves 8x speedup.
428Gbytes/sec?
8, VirtFS: Plan 9 folder sharing.
1), use plan 9 filesystem.
2), mount t 9p -o trans=virtio [mount tag] [mount point] --oversion=9p2000.L

11:17 2014-02-19
http://en.wikipedia.org/wiki/ES_EVM
http://www.atariarchives.org/bcc2/showpage.php?page=13

14:16 2014-02-19
1, I: working around severve firmware bug.
this usually means bios is broken. Consider a update failure?
2, 0x100118: 0x100100 is the list unused.
3, crash
search: searches a range of user or kernel memory space for given value.
4, makedumpfile --dump-dmesg vmcore dmesg.txt
5, lttng.

16:27 2014-02-19
1, LSM: Linux Security Module.
2, SELinux
3, Apparmor
4,
/proc/kmem
/proc/kcore
/proc/kallsyms: kernel symbols.
5, considering the pading. should use memset instead of initialize all the variable individually.
6, Dos: Deny of Service.

14:35 2014-02-20
GTD
0, 10:00

1, today
1), 10:10-11:50 1:1 with roger.
2), 13:00-14:35 doc: extract audio CD; convert wav to mp3. see"17:17 2013-07-30"2.
3), write doc about snapshot. see"15:04 2014-02-20"

15:04 2014-02-20
snapshot, libvirt, libxl, xl
Hi, roger

here is my current the idea about snapshot. it is a little bit far from send it out. i would improment it after i come back.

1, basic requirement about snapshot.
1), snapshot should includes save the memory and take the disk snapshot.
2), snapshot command: create, delete, revert, list and so on, reference the libvirt snapshot command in libvirt:
# virsh help |grep snapshot
    iface-begin                    create a snapshot of current interfaces settings, which can be later committed (iface-commit) or restored (iface-rollback)
 Snapshot (help keyword 'snapshot'):
    snapshot-create                Create a snapshot from XML
    snapshot-create-as             Create a snapshot from a set of args
    snapshot-current               Get or set the current snapshot
    snapshot-delete                Delete a domain snapshot
    snapshot-dumpxml               Dump XML for a domain snapshot
    snapshot-edit                  edit XML for a snapshot
    snapshot-info                  snapshot information
    snapshot-list                  List snapshots for a domain
    snapshot-parent                Get the name of the parent of a snapshot
    snapshot-revert                Revert a domain to a snapshot
3), disk type
(1), basically, support qcow2.
(2), the disk image do not support snapshot: raw. IIRC, RH support this.
(3), other disk: blktap3, lvm snapshot, btrfs, etc.
should we support qcow2 and raw(both use qdisk as backend) in the first version. and then considering others backend.

2, different implementation about snapshot
1), libvirt qemu driver approach.
call the savevm, loadvm and other hmp command in libvirt qemu driver.
it was the first idea when we start this fate. but unfortunately, the xl toolstack do not support the hmp command, only qmp command is supported.
2), old snapshot implementation in sle.
base on qemu-xen. it would be some different compare with qemu upstream.

3, our approach.
1), use exist qmp api as many as possible. modify the qemu code if needed.
2), the current status of qmp.
query-block: could list the internal snapshot.
blockdev-snapshot-sync: take the external snapshot.
blockdev-snapshot-internal-sync: take the internal snapshot.
blockdev-snapshot-delete-internal-sync: delte the internal snapshot.
transaction: a sort of internal/extenal snapshot series.
3), so, for internal disk snapshot, only snapshot revert is missing. i could modify the code like qemu loadvm and old snapshot in sle.
4), snapshot the vm.
the basic flow of snapshot a vm could be:
(1), suspend domain.
(2), save vm memory(both xen and qemu save).
(3), disk snapshot.
(4), resume domain.

4, ref
http://wiki.xen.org/wiki/OutreachProgramForWomen/Round7#VM_Snapshots
http://libvirt.org/formatsnapshot.html

16:15 2014-02-20
stress test
bonnie++ -d .

13:45 2014-02-21
nanrenbei
7EC8

16:46 2014-02-21
suse, EVP
1, should we have the action item about how the opensource works in suse.
e.g. the suggestion about how to communicate with community.
which one is encourage. e.g. have a rest when take part in the community activity.
也就是说如果真的支持这个事情，应该有点干货。而不是走走形式。

11:25 2014-03-03
TODO: check similar regiser as CR0 wp in arm.

14:06 2014-03-03
How to send Ctrl-Alt-Del to my VM?
http://lists.xen.org/archives/html/xen-devel/2009-10/msg00825.html
On Fri, Oct 16, 2009 at 06:02:20PM +0900, Jun Koi wrote:
> Hi,
> 
> My Windows HVM askes me to press Ctrl-Alt-Del to log in. But that keys
> are captured by the host. How can I send those keys to my VM?
> 
> I am using VNCViewer, if that matters.
> 

VNCviewer should have some menu where you can choose to send
ctrl-alt-del. Try pressing F8 (iirc) ?

Or use virt-viewer..

-- Pasi

14:25 2014-03-03
1,
自由度: 自由度. 参考mulei邮件.
分享:
社区: 分享及社区文化参与; 提高公司的社区影响力. 公司鼓励大家参与社区.
即使之前对开源不了解, 来suse之后也越来越了解.
平等: 对于任何个人和团体都没有差别待遇.

基因: 遗传, 进化.
suse: 平台, 鼓励.

过门: 说了这么多, 感觉开源就像阳光, 水和空气一样, 是生活的必须品.

产品会进化。

2, 开源与suse.
开源故事.
问答: 长江有大湖.
Linux: 鄱阳湖. 候鸟的天堂: Linux对于开源世界的影响. distribution: opensuse.
GNOME: 洞庭湖. Sun. David. 养殖基地.
Xen: 太湖. 产螃蟹. Chunyan. 太湖是庞大的灌溉系统.

注意节奏. 突出suse的产品.
基因如何体现?

15:18 2014-03-03
1, Linux贡献排名
http://www.cnbeta.com/articles/265831.htm
RedHat, Intel, TI, Linaro, SUSE, IBM, Samsung, Google.

22:12 2014-03-03
Hi, Jason
> Hi Bamvor,
>
> I have just assigned you the following L3 Xen bug:  Bug 865219 - L3: USB passthrough (qemu-dm) to Windows VM crashed with segfault
yeah, and i have read your discussion in bugzilla.
>
> Do you have time to look into the issue, perhaps while waiting for responses from upstream about your feature work? I know you don't have a lot of experience with the qemu-dm code, but that's the case for pretty much everyone else on the team as well.
>
> I seem to recall Chun Yan dealing with some sort of usb passthrough issue in the past, so she might be able to give you some direction.
after discuss it with Chunyan, i will test with qemu upstream for this bug tomorrow. considering the qemu upstream is default qemu from xen 4.3 and there are lots of difference between qemu-dm and qemu upstream. it worth to try.
>
> If for some reason this bug is going to be overly burdensome to you, please let me know. Thanks.
>
> Jason
>
BTW, i heard from roger that this bug is assigned to others when i am on vacation. is there other guys work on this bug?

regards

bamvor

09:59 2014-03-04
GTD
0, 9:50

1, today
1), 10:20 bnc#865219. see"10:38 2014-03-04"

10:38 2014-03-04
bnc#865219
1, qemu upstream is not support in xm.
TODO try xl usb passthrough. it should be works if customer device is 1.1 usb device.
2, win server 2008 x64, sles11sp3, xen 4.2.2
xen10:/home/images/winserver2008x64 # xm start win2008x64
xen10:/home/images/winserver2008x64 # lsusb
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 002 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 001 Device 002: ID 8087:0020 Intel Corp. Integrated Rate Matching Hub
Bus 002 Device 002: ID 8087:0020 Intel Corp. Integrated Rate Matching Hub
Bus 002 Device 003: ID 0d3d:0040 Tangtop Technology Co., Ltd
Bus 002 Device 004: ID 05e3:0736 Genesys Logic, Inc.
Bus 002 Device 005: ID 046d:c05a Logitech, Inc. Optical Mouse M90
xen10:/home/images/winserver2008x64 # xm usb-list win2008x64
xen10:/home/images/winserver2008x64 # xm usb-add win2008x64 host:05e3:0736
xen10:/home/images/winserver2008x64 # xm usb-add win2008x64 host:046d:c05a

4, kernel message
1), a kernel fault when i have lunch. is it relative?
<0>[11712.207338] general protection fault: 0000 [#1] SMP
<4>[11712.207351] CPU 0
<4>[11712.20754] Modules linked in:  aelr ip_tblterips eb_ebtalsxtale plktaac sb_scik lkacatxnbe nthn _os__sndndevie e_edge lcrodefseloehpotp_modcc_hnd_dadaltha_ntesd_coec dnm cba20pnd_ pp1 dosarpo r5eial to CO_Cvedo_sppolipibcnter skema psrc_iidoe_pac3bdmbaceuh1drmelp c_ago2c_oe smo cc_10if_g lgpguttcdbusbcomoessmalhsciai_dscspcsi_ui_d xc xnntahaibai_m>[117Sud, al712207
>[1075i72,corened:   X 3-11- ellInil 9     /D43[23] IP0<fff3de><ffff819d> d_asex0>[20754] P: e088018b  EFLAS: 00
<4>[1255] RX: 0fb0bf8f1RBX: 00000000 RC:801cba1>2.207560 ffff801d58170 SI: 0000000: ffff5a1005
4>[171. RBP: 0188 R08000 R09 fff881ca64>[1122070ffff83e78 11: 0000012: 00000000
<>[11578] 13:ffffb70 R14 0e3e08 R0000008000120] FS7f161937) GS:fff881e8000(000l:00000
    <>2.205Ce033 D0 ES: R00033
    <4.20760: 00054900 CR3 00004000 C000002661171220768] D00000000 DR1000R 000000000
    <271R000000R6: 00ffffR 00000>[11711] Prcessfired: 77en ffff80186200, ts ff885)<0>[122]k:
<4[177630] f1d95a1f1db58fff880024 ff8801d74[117125ffff8810000000000058018b63e68 fff88785c
<4>26]  fffb6e3f38801d9a100 fff8868fffff81<0>[11668] Ca:[12.20768fffffff803a8atnat+0xd9
<4>[107  [<ff80 89 c3 0f 05 00 48 8b 220 48 8 0f 84d2 0 00 0 8b 41 0 <48[1.28]  83 8 00 0 85 6 f6 45 40 0f84d 00 0
[11712.07826R fffff1391e>] _st+0xe800
<>[1112.27837  RSffff883d78>
4>[1712.20 --- end ce e56c423b478 -

2),
<3>[  236.264052] INFO: rcu_sched_state detected stall on CPU 0 (t=15000 jiffies)
<6>[  236.264052] sending NMI to all CPUs:
<4>[  236.264052] NMI backtrace for cpu 0
<4>[  236.264052] CPU 0
<4>[  236.264052] Modules linked in: usb_storage ip6table_filter ip6_tables iptable_filter ip_tables ebtable_nat ebtables x_tables nbd blktap blktap2 pciback usbbk xen_scsibk blkbk blkback_pagemap netbk xenbus_be gntdev evtchn snd_pcm_oss snd_mixer_oss snd_seq snd_seq_device edd af_packet bridge stp llc microcode fuse loop pciehp pci_hotplug dm_mod snd_hda_codec_hdmi 8250_pnp snd_hda_codec_realtek ppdev parport_pc parport 8250 serial_core sg rtc_cmos dcdbas(X) domctl container iTCO_wdt iTCO_vendor_support ipv6 ipv6_lib dell_wmi pcspkr sparse_keymap snd_hda_intel snd_hda_codec snd_hwdep i2c_i801 snd_pcm e1000e snd_timer snd serio_raw soundcore wmi snd_page_alloc ext3 jbd mbcache usbhid hid i915 drm_kms_helper drm i2c_algo_bit i2c_core video sd_mod crc_t10dif ehci_hcd usbcore usb_common intel_agp intel_gtt agpgart button processor thermal_sys hwmon scsi_dh_rdac scsi_dh_emc scsi_dh_hp_sw scsi_dh_alua scsi_dh xenblk cdrom xennet ahci libahci libata scsi_mod
<4>[  236.264052] Supported: Yes, External
<4>[  236.264052]
<4>[  236.264052] Pid: 4962, comm: firefox Tainted: G      D W   X 3.0.76-0.11-xen #1 Dell Inc. OptiPlex 980                 /0D438T
<4>[  236.264052] RIP: e030:[<ffffffff8000330a>]  [<ffffffff8000330a>] HYPERVISOR_vcpu_op+0xa/0x20
<4>[  236.264052] RSP: e02b:ffff8801e4803d00  EFLAGS: 00000046
<4>[  236.264052] RAX: 0000000000000000 RBX: 0000000000000000 RCX: ffffffff8000330a
<4>[  236.264052] RDX: 0000000000000000 RSI: 0000000000000000 RDI: 000000000000000b
<4>[  236.264052] RBP: ffffffff80736ce0 R08: 0000000000000200 R09: ffffffff80736ce0
<4>[  236.264052] R10: 0720072007200720 R11: 0000000000000246 R12: 0000000000000002
<4>[  236.264052] R13: ffffffff80736ce0 R14: ffff8801e4807740 R15: ffff8801e4803e68
<4>[  236.264052] FS:  00007f56726ce720(0000) GS:ffff8801e4800000(0000) knlGS:0000000000000000
<4>[  236.264052] CS:  e033 DS: 0000 ES: 0000 CR0: 0000000080050033
<4>[  236.264052] CR2: 00007f5665a838e0 CR3: 00000001d16c7000 CR4: 0000000000002660
<4>[  236.264052] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
<4>[  236.264052] DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400
<4>[  236.264052] Process firefox (pid: 4962, threadinfo ffff8801c71d2000, task ffff8801c7210580)
<0>[  236.264052] Stack:
<4>[  236.264052]  0720072007200720 0000000000000000 ffffffff802e9f2c ffff8801e4803d28
<4>[  236.264052]  00000000ffffffff ffffffff80736ce0 ffffffff8001875a ffffffff80736ce0
<4>[  236.264052]  0000000000000000 ffffffff806e8d00 ffffffff806e8e00 ffffffff8007a590
<0>[  236.264052] Call Trace:
<4>[  236.264052]  [<ffffffff802e9f2c>] notify_remote_via_ipi+0x4c/0xa0
<4>[  236.264052]  [<ffffffff8001875a>] xen_send_IPI_mask+0x3a/0x70
<4>[  236.264052]  [<ffffffff800188ca>] arch_trigger_all_cpu_backtrace+0x8a/0xd0
<4>[  236.264052]  [<ffffffff800aed15>] check_cpu_stall+0xa5/0x100
<4>[  236.264052]  [<ffffffff800aed99>] __rcu_pending+0x29/0x180
<4>[  236.264052]  [<ffffffff800aef4f>] rcu_check_callbacks+0x5f/0x110
<4>[  236.264052]  [<ffffffff8005678f>] update_process_times+0x3f/0x80
<4>[  236.264052]  [<ffffffff8007a5eb>] tick_sched_timer+0x5b/0xc0
<4>[  236.264052]  [<ffffffff8006e13e>] __run_hrtimer+0xde/0x1c0
<4>[  236.264052]  [<ffffffff8006e487>] hrtimer_interrupt+0xe7/0x260
<4>[  236.264052]  [<ffffffff802f0395>] timer_interrupt+0x35/0x100
<4>[  236.264052]  [<ffffffff800a7de2>] handle_irq_event_percpu+0x62/0x1d0
<4>[  236.264052]  [<ffffffff800aaa12>] handle_percpu_irq+0x42/0x80
<4>[  236.264052]  [<ffffffff8000867a>] handle_irq+0x1a/0x30
<4>[  236.264052]  [<ffffffff802ea177>] evtchn_do_upcall+0x1c7/0x310
<4>[  236.264052]  [<ffffffff804123de>] do_hypervisor_callback+0x1e/0x30
<4>[  236.264052]  [<ffffffff8021aee7>] radix_tree_lookup_slot+0x27/0x60
<4>[  236.264052]  [<ffffffff800db798>] find_get_page+0x18/0xb0
<4>[  236.264052]  [<ffffffff800dce77>] filemap_fault+0x97/0x3e0
<4>[  236.264052]  [<ffffffff800ffea2>] __do_fault+0x72/0x720
<4>[  236.264052]  [<ffffffff801042e1>] handle_pte_fault+0xa1/0x290
<4>[  236.264052]  [<ffffffff8040da21>] do_page_fault+0x251/0x540
<4>[  236.264052]  [<ffffffff8040a2d8>] page_fault+0x28/0x30
<4>[  236.264052]  [<00007f56724fff33>] 0x7f56724fff32
<0>[  236.264052] Code: cc 51 41 53 50 b8 17 00 00 00 0f 05 5b 59 c3 cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc 51 41 53 b8 18 00 00 00 0f 05
<41>[  236.264052]  5b 59 c3 cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc
<4>[  236.264052] Call Trace:
<4>[  236.264052]  [<ffffffff802e9f2c>] notify_remote_via_ipi+0x4c/0xa0
<4>[  236.264052]  [<ffffffff8001875a>] xen_send_IPI_mask+0x3a/0x70
<4>[  236.264052]  [<ffffffff800188ca>] arch_trigger_all_cpu_backtrace+0x8a/0xd0
<4>[  236.264052]  [<ffffffff800aed15>] check_cpu_stall+0xa5/0x100
<4>[  236.264052]  [<ffffffff800aed99>] __rcu_pending+0x29/0x180
<4>[  236.264052]  [<ffffffff800aef4f>] rcu_check_callbacks+0x5f/0x110
<4>[  236.264052]  [<ffffffff8005678f>] update_process_times+0x3f/0x80
<4>[  236.264052]  [<ffffffff8007a5eb>] tick_sched_timer+0x5b/0xc0
<4>[  236.264052]  [<ffffffff8006e13e>] __run_hrtimer+0xde/0x1c0
<4>[  236.264052]  [<ffffffff8006e487>] hrtimer_interrupt+0xe7/0x260
<4>[  236.264052]  [<ffffffff802f0395>] timer_interrupt+0x35/0x100
<4>[  236.264052]  [<ffffffff800a7de2>] handle_irq_event_percpu+0x62/0x1d0
<4>[  236.264052]  [<ffffffff800aaa12>] handle_percpu_irq+0x42/0x80
<4>[  236.264052]  [<ffffffff8000867a>] handle_irq+0x1a/0x30
<4>[  236.264052]  [<ffffffff802ea177>] evtchn_do_upcall+0x1c7/0x310
<4>[  236.264052]  [<ffffffff804123de>] do_hypervisor_callback+0x1e/0x30
<4>[  236.264052]  [<ffffffff8021aee7>] radix_tree_lookup_slot+0x27/0x60
<4>[  236.264052]  [<ffffffff800db798>] find_get_page+0x18/0xb0
<4>[  236.264052]  [<ffffffff800dce77>] filemap_fault+0x97/0x3e0
<4>[  236.264052]  [<ffffffff800ffea2>] __do_fault+0x72/0x720
<4>[  236.264052]  [<ffffffff801042e1>] handle_pte_fault+0xa1/0x290
<4>[  236.264052]  [<ffffffff8040da21>] do_page_fault+0x251/0x540
<4>[  236.264052]  [<ffffffff8040a2d8>] page_fault+0x28/0x30
<4>[  236.264052]  [<00007f56724fff33>] 0x7f56724fff32
<4>[  236.264508] NMI backtrace for cpu 1
<4>[  236.264528] CPU 1
<4>[  236.264529] Modules linked in: usb_storage ip6table_filter ip6_tables iptable_filter ip_tables ebtable_nat ebtables x_tables nbd blktap blktap2 pciback usbbk xen_scsibk blkbk blkback_pagemap netbk xenbus_be gntdev evtchn snd_pcm_oss snd_mixer_oss snd_seq snd_seq_device edd af_packet bridge stp llc microcode fuse loop pciehp pci_hotplug dm_mod snd_hda_codec_hdmi 8250_pnp snd_hda_codec_realtek ppdev parport_pc parport 8250 serial_core sg rtc_cmos dcdbas(X) domctl container iTCO_wdt iTCO_vendor_support ipv6 ipv6_lib dell_wmi pcspkr sparse_keymap snd_hda_intel snd_hda_codec snd_hwdep i2c_i801 snd_pcm e1000e snd_timer snd serio_raw soundcore wmi snd_page_alloc ext3 jbd mbcache usbhid hid i915 drm_kms_helper drm i2c_algo_bit i2c_core video sd_mod crc_t10dif ehci_hcd usbcore usb_common intel_agp intel_gtt agpgart button processor thermal_sys hwmon scsi_dh_rdac scsi_dh_emc scsi_dh_hp_sw scsi_dh_alua scsi_dh xenblk cdrom xennet ahci libahci libata scsi_mod
<4>[  236.264590] Supported: Yes, External
<4>[  236.264590]
<4>[  236.264590] Pid: 0, comm: swapper Tainted: G      D W   X 3.0.76-0.11-xen #1 Dell Inc. OptiPlex 980                 /0D438T
<4>[  236.264590] RIP: e030:[<ffffffff800033aa>]  [<ffffffff800033aa>] HYPERVISOR_sched_op_new+0xa/0x20
<4>[  236.264590] RSP: e02b:ffff8801db921f08  EFLAGS: 00000246
<4>[  236.264590] RAX: 0000000000000000 RBX: ffff8801db920010 RCX: ffffffff800033aa
<4>[  236.264590] RDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000000000001
<4>[  236.264590] RBP: 0000000000000001 R08: 0000000000000000 R09: ffffffff80736ce0
<4>[  236.264590] R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
<4>[  236.264590] R13: 0000000000000000 R14: 0000000000000000 R15: 0000000000000000
<4>[  236.264590] FS:  00007fd5a0af0700(0000) GS:ffff8801e4880000(0000) knlGS:0000000000000000
<4>[  236.264590] CS:  e033 DS: 002b ES: 002b CR0: 000000008005003b
<4>[  236.264590] CR2: 00007f0446d24f90 CR3: 00000001cfb07000 CR4: 0000000000002660
<4>[  236.264590] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
<4>[  236.264590] DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400
<4>[  236.264590] Process swapper (pid: 0, threadinfo ffff8801db920000, task ffff8801db91e0c0)
<0>[  236.264590] Stack:
<4>[  236.264590]  0000000000000000 00000000ffffffff ffffffff8000ddf7 0000000000000000
<4>[  236.264590]  ffff8801db920010 ffffffff80736ce0 ffffffff80006677 0000000000000000
<4>[  236.264590]  0000000000000000 0000000000000000 0000000000000000 0000000000000000
<0>[  236.264590] Call Trace:
<4>[  236.264590]  [<ffffffff8000ddf7>] xen_idle+0xb7/0x180
<4>[  236.264590]  [<ffffffff80006677>] cpu_idle+0x67/0xb0
<0>[  236.264590] Code: cc 51 41 53 b8 1c 00 00 00 0f 05 41 5b 59 c3 cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc 51 41 53 b8 1d 00 00 00 0f 05
<41>[  236.264590]  5b 59 c3 cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc
<4>[  236.264590] Call Trace:
<4>[  236.264590]  [<ffffffff8000ddf7>] xen_idle+0xb7/0x180
<4>[  236.264590]  [<ffffffff80006677>] cpu_idle+0x67/0xb0
<4>[  236.264735] NMI backtrace for cpu 2
<4>[  236.264740] CPU 2
<4>[  236.264742] Modules linked in: usb_storage ip6table_filter ip6_tables iptable_filter ip_tables ebtable_nat ebtables x_tables nbd blktap blktap2 pciback usbbk xen_scsibk blkbk blkback_pagemap netbk xenbus_be gntdev evtchn snd_pcm_oss snd_mixer_oss snd_seq snd_seq_device edd af_packet bridge stp llc microcode fuse loop pciehp pci_hotplug dm_mod snd_hda_codec_hdmi 8250_pnp snd_hda_codec_realtek ppdev parport_pc parport 8250 serial_core sg rtc_cmos dcdbas(X) domctl container iTCO_wdt iTCO_vendor_support ipv6 ipv6_lib dell_wmi pcspkr sparse_keymap snd_hda_intel snd_hda_codec snd_hwdep i2c_i801 snd_pcm e1000e snd_timer snd serio_raw soundcore wmi snd_page_alloc ext3 jbd mbcache usbhid hid i915 drm_kms_helper drm i2c_algo_bit i2c_core video sd_mod crc_t10dif ehci_hcd usbcore usb_common intel_agp intel_gtt agpgart button processor thermal_sys hwmon scsi_dh_rdac scsi_dh_emc scsi_dh_hp_sw scsi_dh_alua scsi_dh xenblk cdrom xennet ahci libahci libata scsi_mod
<4>[  236.264860] Supported: Yes, External
<4>[  236.264864]
<4>[  236.264868] Pid: 0, comm: swapper Tainted: G      D W   X 3.0.76-0.11-xen #1 Dell Inc. OptiPlex 980                 /0D438T
<4>[  236.264876] RIP: e030:[<ffffffff800033aa>]  [<ffffffff800033aa>] HYPERVISOR_sched_op_new+0xa/0x20
<4>[  236.264885] RSP: e02b:ffff8801db925f08  EFLAGS: 00000246
<4>[  236.264890] RAX: 0000000000000000 RBX: ffff8801db924010 RCX: ffffffff800033aa
<4>[  236.264895] RDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000000000001
<4>[  236.264900] RBP: 0000000000000002 R08: 0000000000000000 R09: ffffffff80736ce0
<4>[  236.264905] R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
<4>[  236.264910] R13: 0000000000000000 R14: 0000000000000000 R15: 0000000000000000
<4>[  236.264918] FS:  00007f4858acc760(0000) GS:ffff8801e4900000(0000) knlGS:0000000000000000
<4>[  236.264924] CS:  e033 DS: 002b ES: 002b CR0: 000000008005003b
<4>[  236.264929] CR2: 00000000006d3ff0 CR3: 00000001cb333000 CR4: 0000000000002660
<4>[  236.264934] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
<4>[  236.264939] DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400
<4>[  236.264945] Process swapper (pid: 0, threadinfo ffff8801db924000, task ffff8801db922100)
<0>[  236.264950] Stack:
<4>[  236.264953]  0000000000000000 00000000ffffffff ffffffff8000ddf7 0000000000000000
<4>[  236.264961]  ffff8801db924010 ffffffff80736ce0 ffffffff80006677 0000000000000000
<4>[  236.264968]  0000000000000000 0000000000000000 0000000000000000 0000000000000000
<0>[  236.264976] Call Trace:
<4>[  236.264987]  [<ffffffff8000ddf7>] xen_idle+0xb7/0x180
<4>[  236.264994]  [<ffffffff80006677>] cpu_idle+0x67/0xb0
<0>[  236.264999] Code: cc 51 41 53 b8 1c 00 00 00 0f 05 41 5b 59 c3 cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc 51 41 53 b8 1d 00 00 00 0f 05
<41>[  236.265038]  5b 59 c3 cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc
<4>[  236.265060] Call Trace:
<4>[  236.265069]  [<ffffffff8000ddf7>] xen_idle+0xb7/0x180
<4>[  236.265076]  [<ffffffff80006677>] cpu_idle+0x67/0xb0
<4>[  236.265118] NMI backtrace for cpu 3
<4>[  236.265124] CPU 3
<4>[  236.265126] Modules linked in: usb_storage ip6table_filter ip6_tables iptable_filter ip_tables ebtable_nat ebtables x_tables nbd blktap blktap2 pciback usbbk xen_scsibk blkbk blkback_pagemap netbk xenbus_be gntdev evtchn snd_pcm_oss snd_mixer_oss snd_seq snd_seq_device edd af_packet bridge stp llc microcode fuse loop pciehp pci_hotplug dm_mod snd_hda_codec_hdmi 8250_pnp snd_hda_codec_realtek ppdev parport_pc parport 8250 serial_core sg rtc_cmos dcdbas(X) domctl container iTCO_wdt iTCO_vendor_support ipv6 ipv6_lib dell_wmi pcspkr sparse_keymap snd_hda_intel snd_hda_codec snd_hwdep i2c_i801 snd_pcm e1000e snd_timer snd serio_raw soundcore wmi snd_page_alloc ext3 jbd mbcache usbhid hid i915 drm_kms_helper drm i2c_algo_bit i2c_core video sd_mod crc_t10dif ehci_hcd usbcore usb_common intel_agp intel_gtt agpgart button processor thermal_sys hwmon scsi_dh_rdac scsi_dh_emc scsi_dh_hp_sw scsi_dh_alua scsi_dh xenblk cdrom xennet ahci libahci libata scsi_mod
<4>[  236.265269] Supported: Yes, External
<4>[  236.265273]
<4>[  236.265277] Pid: 0, comm: swapper Tainted: G      D W   X 3.0.76-0.11-xen #1 Dell Inc. OptiPlex 980                 /0D438T
<4>[  236.265285] RIP: e030:[<ffffffff800033aa>]  [<ffffffff800033aa>] HYPERVISOR_sched_op_new+0xa/0x20
<4>[  236.265294] RSP: e02b:ffff8801db929f08  EFLAGS: 00000246
<4>[  236.265299] RAX: 0000000000000000 RBX: ffff8801db928010 RCX: ffffffff800033aa
<4>[  236.265303] RDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000000000001
<4>[  236.265308] RBP: 0000000000000003 R08: 0000000000000000 R09: ffffffff80736ce0
<4>[  236.265313] R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
<4>[  236.265317] R13: 0000000000000000 R14: 0000000000000000 R15: 0000000000000000
<4>[  236.265325] FS:  00007fe1efa8f7a0(0000) GS:ffff8801e4980000(0000) knlGS:0000000000000000
<4>[  236.265330] CS:  e033 DS: 002b ES: 002b CR0: 000000008005003b
<4>[  236.265335] CR2: 00007f9147148000 CR3: 00000001db211000 CR4: 0000000000002660
<4>[  236.265340] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
<4>[  236.265345] DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400
<4>[  236.265350] Process swapper (pid: 0, threadinfo ffff8801db928000, task ffff8801db926140)
<0>[  236.265354] Stack:
<4>[  236.265357]  0000000000000000 00000000ffffffff ffffffff8000ddf7 0000000000000000
<4>[  236.265367]  ffff8801db928010 ffffffff80736ce0 ffffffff80006677 0000000000000000
<4>[  236.265375]  0000000000000000 0000000000000000 0000000000000000 0000000000000000
<0>[  236.265384] Call Trace:
<4>[  236.265395]  [<ffffffff8000ddf7>] xen_idle+0xb7/0x180
<4>[  236.265401]  [<ffffffff80006677>] cpu_idle+0x67/0xb0
<0>[  236.265407] Code: cc 51 41 53 b8 1c 00 00 00 0f 05 41 5b 59 c3 cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc 51 41 53 b8 1d 00 00 00 0f 05
<41>[  236.265455]  5b 59 c3 cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc
<4>[  236.265481] Call Trace:
<4>[  236.265491]  [<ffffffff8000ddf7>] xen_idle+0xb7/0x180
<4>[  236.265497]  [<ffffffff80006677>] cpu_idle+0x67/0xb0

5, relative bug.
1), https://bugzilla.novell.com/show_bug.cgi?id=767864
2), https://bugs.launchpad.net/qemu/+bug/685096
it might be relative to which usb protocol pass to guest.
Serge Hallyn (serge-hallyn) wrote on 2014-02-06: Re: [Bug 685096] Re: USB Passthrough not working for Windows 7 guest    #25
Quoting Manuel Baesler (<email address hidden>):
[...]
Thanks - so (this isn't documented in the qemu man page) am I to assume
that given " -usbdevice host:0781:5150" as the original bug submitter is
doing means "give me usb 1.0" ?

Max, does it work for you if you use (...taking a wild guess) :

 -device usb-ehci,id=usb,bus=pci.0,addr=0x4 \
 -device usb-host,vendorid=0x0781,productid=0x5150,id=hostdev0,bus=usb.0

or perhaps

 -device usb-ehci,id=usb,bus=pci.0,addr=0x4 \
 -usbdevice tablet \
 -device usb-host,vendorid=0x0781,productid=0x5150,id=hostdev0,bus=usb.0

You also might try xhci in place of ehci.

(If this does turn out to be the answer, then the bug title should be
changed to include 'usb2.0 and usb3.0 devices', to aid people in
finding this gem in the future)

 status: incomplete

Changed in qemu-kvm (Ubuntu):
status:  Confirmed → Incomplete
Manuel Baesler (v-launchpad-manuelbaesler) wrote on 2014-02-12:  #26
RIght, with '-usb' qemu creates then 'piix3-usb-uhci' device:

00:01.2 USB controller: Intel Corporation 82371SB PIIX3 USB [Natoma/Triton II] (rev 01)

5, try
usb-add -> usb-delete -> new(with usb passthrough) -> start -> usb-add
xen10:/home/images/winserver2008x64 # xm usb-add win2008x64 host:046d:c05a
Error: Timed out waiting for device model action
Usage: xm usb-add <domain> <[host:bus.addr] [host:vendor_id:product_id]>

Add the usb device to FV VM.

6, reply to jason email
> Hi Bamvor,
> 
> Welcome back.
> 
> > On Mar 3, 2014, at 8:43 AM, "Bamvor Jian Zhang" <bjzhang@suse.com> wrote:
> >
> > Hi, Jason
> >> Hi Bamvor,
> >>
> >> I have just assigned you the following L3 Xen bug:  Bug 865219 - L3: USB passthrough (qemu-dm) to Windows VM crashed with segfault
> > yeah, and i have read your discussion in bugzilla.
> >>
> >> Do you have time to look into the issue, perhaps while waiting for responses from upstream about your feature work? I know you don't have a lot of experience with the qemu-dm code, but that's the case for pretty much everyone else on the team as well.
> >>
> >> I seem to recall Chun Yan dealing with some sort of usb passthrough issue in the past, so she might be able to give you some direction.
> > after discuss it with Chunyan, i will test with qemu upstream for this bug tomorrow. considering the qemu upstream is default qemu from xen 4.3 and there are lots of difference between qemu-dm and qemu upstream. it worth to try.
> 
> That's essentially what Kirk tried. He found that in the upstream qemu-kvm, USB 1.1 emulation is still broken but that USB 2.0 works … at least, it works with his device. I think it would make sense to see if we can replicate those results under Xen.
i found that xm do not support qemu upstream according to my test and xen wiki.
> 
> >>
> >> If for some reason this bug is going to be overly burdensome to you, please let me know. Thanks.
> >>
> >> Jason
> > BTW, i heard from roger that this bug is assigned to others when i am on vacation. is there other guys work on this bug?
> 
> As mentioned, Kirk looked at this and posted his results in the bug. The only other significant work was my investigation of the possible workarounds (also in the bug), which were all deemed unworkable for the customer.

i tested on sle11sp3 xen(fully patched). it seems that usb1.1 device(mouse) is ok no matter "xm usb-add" or passthrough in xm config file. while usb2.0 device(usb mass storage: tf card reader with tf card) fails in both ways.
my test step is
1), add usb device with "xm usb-add".
2), shutdown guest.
3), xm delete
4), add usb device in config file
#e.g. take mouse for example
usb=1
usbdevice='host:046d:c05a'
5), xm new
6), xm start
7), check usb device passthrough status
8), restore the config file

i test these cycle for mouse more than 4 times. every time is ok.
it is just a little bit different between usb-add and config file:
there are two HID mice in guest after usb-add. one of them is usb passthrough mouse. there are only one mouse in guest after passthrought the same usb mouse in config file.

my test environment
host: sle11sp3(3.0.101-0.15-xen) with xen4.2.4_02
guest: win server 2008


second comment
it might be relative to which usb protocol pass to guest. in qemu-dm my usb2.0 device(tf card reader) is attached to usb1.1 hub. qemu upstream could support usb ehci in "-device" parameter. but i do not how use pass echi in qemu-dm.

link: https://bugs.launchpad.net/qemu/+bug/685096

the relative discuss in this link:
Serge Hallyn (serge-hallyn) wrote on 2014-02-06: Re: [Bug 685096] Re: USB Passthrough not working for Windows 7 guest    #25
Quoting Manuel Baesler (<email address hidden>):
[...]
Thanks - so (this isn't documented in the qemu man page) am I to assume
that given " -usbdevice host:0781:5150" as the original bug submitter is
doing means "give me usb 1.0" ?

Max, does it work for you if you use (...taking a wild guess) :

 -device usb-ehci,id=usb,bus=pci.0,addr=0x4 \
 -device usb-host,vendorid=0x0781,productid=0x5150,id=hostdev0,bus=usb.0

or perhaps

 -device usb-ehci,id=usb,bus=pci.0,addr=0x4 \
 -usbdevice tablet \
 -device usb-host,vendorid=0x0781,productid=0x5150,id=hostdev0,bus=usb.0

You also might try xhci in place of ehci.

(If this does turn out to be the answer, then the bug title should be
changed to include 'usb2.0 and usb3.0 devices', to aid people in
finding this gem in the future)

 status: incomplete

Changed in qemu-kvm (Ubuntu):
status:  Confirmed → Incomplete
Manuel Baesler (v-launchpad-manuelbaesler) wrote on 2014-02-12:  #26
RIght, with '-usb' qemu creates then 'piix3-usb-uhci' device:

00:01.2 USB controller: Intel Corporation 82371SB PIIX3 USB [Natoma/Triton II] (rev 01)

5, try

> 
> Bruce had a couple ideas of how this could be analyzed, but he is buried under his own work right now. I've added him to the cc in case he has any suggestions for you.
> 
> Jason

16:09 2014-03-04
/dev/sda1              63       80324       40131    6  FAT16
Partition 1 does not start on physical sector boundary.
/dev/sda2           81920    21671935    10795008    7  HPFS/NTFS/exFAT
/dev/sda3        21671936   189438729    83883397    7  HPFS/NTFS/exFAT
/dev/sda4   *   189440000   976773119   393666560    f  W95 Ext'd (LBA)
/dev/sda5       193986560   823138303   314575872   83  Linux
/dev/sda5 on /home/bamvor/sda5_rd type btrfs (rw,relatime,space_cache)

/dev/sda6       823140352   886050815    31455232   83  Linux
/dev/sda7       886052864   898615295     6281216   83  Linux
/dev/sda7 on /home/bamvor/sles11_sp2_home type ext3 (rw,relatime,data=ordered)

/dev/sda8       189442048   189759487      158720   83  Linux
/dev/sda9       189761536   193984511     2111488   8e  Linux LVM
/dev/sda10      915402752   976752639    30674944   8e  Linux LVM
/dev/sda11      898617344   899641343      512000   83  Linux
/dev/sda12      899643392   915400703     7878656   82  Linux swap / Solaris
/dev/sdb: 160.0 GB, 160041885696 bytes
/dev/sdb1            2048   207724543   103861248   83  Linux
/dev/sdb2       207724544   209840127     1057792   83  Linux
/dev/sdb3       209840128   262277119    26218496   8e  Linux LVM

Disk /dev/sdc: 80.0 GB, 80000000000 bytes
/dev/sdc1            2048   156249999    78123976   83  Linux

Disk /dev/mapper/system2-root: 16.1 GB, 16106127360 bytes
opensuse 12.3 (2) root

Disk /dev/mapper/system2-swap: 4294 MB, 4294967296 bytes

Disk /dev/mapper/system-home: 17.2 GB, 17179869184 bytes

Disk /dev/mapper/system-root: 16.4 GB, 16387145728 bytes

