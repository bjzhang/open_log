
周计划
-----
1. 部署trove
2. 写TiDB安装脚本。
3. 入职考试
    1. 完成三人行入职考试。
    2. 周五转正考试 
4. 给mark发邮件。
5. 可选：
    1. 准备TiDB arm环境。
    2. TiDB分享整理。
    3. 找凡一老师。

2017-12-25 
----------
1. 中软光盘镜像（使用kiwi ng） "15:34 2017-12-25"
2. 刘蓓，漏水。
3. 工作累了去711买玉米。
4.  我觉得我方向搞错了，我现在缺的其实是手机端好用的软件。PC端用命令行+git没什么问题。slack edit的markdown语法解析还是有些不同。
    1.  需求是需要一个手机上能否方便使用的客户端。例如使用evernote，其实就是evernote和markdown的双向转换工具。
    2.  evernote to markdown <https://github.com/exomut/evernote-dump>
    3.  markdown to evernote?

15:34 2017-12-25
----------------
2. 兴义需求：
    1. root分区30G，有一个var分区，50G以上。
    2. 用户管理：
        1. 建一个cloud-user用户，密码为cloudpassw0rd, 有sudo权限
        2. 建一个fsuser用户, 密码为fspassword，group为10099, 配置为不可登录：
           ```
           groupadd fsuser -g 10099
           useradd -u 10099 fsuser -g fsuser  -s /sbin/nologin
           echo -ne "fspassword\nfspassword\n" | smbpasswd -a  fsuser
           ```
        3. 配置一下yum源:
           ```
           "repo_ceph":  "http://mirrors.aliyun.com/centos/7.4.1708/storage/x86_64/ceph-luminous/",
           "repo_epel":  "http://mirrors.aliyun.com/epel/7/x86_64/",
           "repo_os":  "http://mirrors.aliyun.com/centos/7.4.1708/os/x86_64/",
           "repo_updates":  "http://mirrors.aliyun.com/centos/7.4.1708/updates/x86_64/",
           "repo_extras":  "http://mirrors.aliyun.com/centos/7.4.1708/extras/x86_64/",
           "repo_cephdeploy":  "https://mirrors.aliyun.com/ceph/rpm-luminous/el7/noarch/",
           "repo_samba":  "http://sambarepo.los-cn-north-1.lecloudapis.com"
           ```
        4. 安装以下包：
           ```
           yum install fabric ceph ceph-common ceph-deploy nfs-utils -y
           yum install --disablerepo=* --enablerepo=repo_samba --enablerepo=repo_os samba samba-vfs-cephfs ctdb samba-client -y
           ```
2. 技术需求
    1. 添加带优先级的repo，安装指定包。16:05-
    2. 硬盘分区。
    3. 建立用户和组。
    4. 光盘启动安装。
    5. 复制本地镜像。

18:00 2017-12-25
----------------
```
suse01@osh01:/usr/lib/python3.4/site-packages/kiwi> sudo cat
/home/suse01/works/software/kiwi/build/image-root/tmpipepc1cv
[main]
cachedir=/var/cache/kiwi/yum/cache
reposdir=/var/cache/kiwi/yum/repos
pluginconfpath=/var/cache/kiwi/yum/pluginconf
keepcache=1
debuglevel=2
pkgpolicy=newest
tolerant=0
exactarch=1
obsoletes=1
plugins=1
gpgcheck=0
metadata_expire=1800
group_command=compat
```

```
[ ERROR   ]: 05:12:41 | KiwiInstallPhaseFailed: System package installation failed: Main config did not have a requires_policy attr. before setopt
Error: Package: 2:ceph-base-12.2.1-0.el7.x86_64 (repo_ceph)
           Requires: librados2 = 2:12.2.1-0.el7
           Available: 1:librados2-0.94.5-2.el7.i686 (repo_os)
               librados2 = 1:0.94.5-2.el7

```

```
[ INFO    ]: 05:04:03 | ['yum', '-c', '/home/suse01/works/software/kiwi/build/image-root/tmpg2df016c', '-y', '--installroot', '/home/suse01/works/software/kiwi/build/image-root', '--setopt=requires_policy=strong', 'install', 'basesystem', 'filesystem', 'grub2-efi', 'grub2-efi-modules', 'shim', 'yum', 'yum-plugin-priorities']
```

```
> sudo wget http://sambarepo.los-cn-north-1.lecloudapis.com/repodata/repomd.xml
> cat  ./repomd.sh
wget http://sambarepo.los-cn-north-1.lecloudapis.com/repodata/f76a920a584b1cb59c301dbbf6b2939c562e62c0ffbebb92b8455389a39d6943-filelists.xml.gz
wget http://sambarepo.los-cn-north-1.lecloudapis.com/repodata/87515c115690d1a5024020186e82b7dd58774d3ae4434c9b2c2f04954e0beddf-primary.xml.gz
wget http://sambarepo.los-cn-north-1.lecloudapis.com/repodata/005d5620dde70ddcf60764f2de833b2bfbd1f4cb75949592388c0340ed5afdd9-primary.sqlite.bz2
wget http://sambarepo.los-cn-north-1.lecloudapis.com/repodata/1d56b97d82cf346451ef326b831403feedf343901a806f74d5aa1b0bb818b76a-other.sqlite.bz2
wget http://sambarepo.los-cn-north-1.lecloudapis.com/repodata/796ccd3b13606fd18a5e4b6710302ad5f60117aabafa5b8967fe4327128bf3f7-other.xml.gz
wget http://sambarepo.los-cn-north-1.lecloudapis.com/repodata/e76bac4b8275f283677a527b0393ada7958df767680e323fbb3623f9bb44b3d9-filelists.sqlite.bz2
```
